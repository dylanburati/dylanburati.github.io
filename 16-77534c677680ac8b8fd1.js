(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"1OyB":function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}t.d(n,"a",(function(){return r}))},KSVO:function(e,n,t){"use strict";t.r(n);var r=t("JX7q"),i=t("dI71"),s=t("q1tI"),a=t.n(s),o=t("1OyB"),c=t("vuIU");function u(e){return"Expression"===e.kind?"(".concat(e.children.map(u).join(" "),")"):e.source}var l,h=new Map;h.set("LineComment",/;.*?$/m),h.set("BlockComment",/#\|.*?\|#/),h.set("ExpressionStart",/[[(]/),h.set("ExpressionEnd",/[\])]/),h.set("String",/"(?:"|(?:[^"]+?)*(?:\\\\"|[^\\]"))/),h.set("Number",/[-+]?(?:[0-9]+(?:\.?[0-9]*)?|\.[0-9]+)(?:e[-+]?[0-9]+)?/),h.set("Symbol",/'[^\][(){}|\s ,`"'#][^\][(){}|\s ,`"'#]*/),h.set("Variable",/[^\][(){}|\s ,`"'#][^\][(){}|\s ,`"'#]*/),function(e){e[e.InProgress=0]="InProgress",e[e.Done=1]="Done",e[e.FoundUnclosed=2]="FoundUnclosed",e[e.FoundTrailing=3]="FoundTrailing"}(l||(l={}));var d=function(){function e(n){Object(o.a)(this,e),this.code=n,this.root={kind:"Expression",children:[]},this.contextStack=[],this.context=this.root,this.status=l.InProgress}return Object(c.a)(e,[{key:"advance",value:function(){if(this.status!==l.InProgress)throw new Error("Parser can not advance past last context");var e,n,t,r=(e=this.code,n=!1,t=null,h.forEach((function(r,i){var s,a,o=r.exec(e);if(null!=o){var c=function(e){return{index:e.index,length:e[0].length,match:e[0]}}(o);a=c,null!=(s=t)&&(s.index<a.index||s.index===a.index&&s.length>=a.length)||(t=c,n=i)}})),!1!==n&&null!=t&&{step:n,span:t});if(!1!==r){if("ExpressionStart"===r.step){var i={kind:"Expression",children:[]};this.context.children.push(i),this.contextStack.push(this.context),this.context=i}else if("ExpressionEnd"===r.step){var s=this.contextStack.pop();if(null==s)return void(this.status=l.FoundTrailing);this.context=s}else this.context.children.push({kind:r.step,source:r.span.match});this.code=this.code.substring(r.span.index+r.span.length)}else 0===this.contextStack.length?this.status=l.Done:this.status=l.FoundUnclosed}},{key:"getLastRacketNode",value:function(){return this.context.children.length>0?this.context.children[this.context.children.length-1]:null}}]),e}();var f=t("BsWD");function p(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],r=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(t.push(a.value),!n||t.length!==n);r=!0);}catch(c){i=!0,s=c}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return t}}(e,n)||Object(f.a)(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=t("KQm4"),m=t("LvDl");function v(e){if("LineComment"===e.kind&&e.source.includes(":")&&e.source.includes("->")){for(var n="(".concat(e.source.replace(/^[; ]+/,"").replace(":"," : "),")"),t=new d(n);t.status===l.InProgress;)t.advance();if(t.status===l.Done&&t.root.children.length>0){var r=t.root.children[0],i={kind:"Variable",source:"->"};if("Expression"===r.kind&&r.children.length>3&&"Variable"===r.children[0].kind&&Object(m.isMatch)(r.children[1],{kind:"Variable",source:":"})){if(1!==r.children.map((function(e,n){return Object(m.isMatch)(e,i)?n:-1})).filter((function(e){return e>=0})).length)return!1;if(r.children[0].source.endsWith("-temp")&&r.children.some((function(e){return"Variable"===e.kind&&/^\?+$/.test(e.source)})))return!1;var s={kind:"FunctionDesign",name:"",purposeLines:0,tests:0,warnings:[]};return s.name=r.children[0].source,s}}}return!1}function b(e){return"Expression"===e.kind&&Object(m.isMatch)(e.children[0],{kind:"Variable",source:"define"})&&"Variable"===e.children[1].kind&&/^[A-Z0-9-]+$/.test(e.children[1].source)}function k(e){return"Variable"===e.kind?/^\.{2,6}$/.test(e.source):"Expression"===e.kind&&null!=e.children.find(k)}var y=["check-expect","check-random","check-satisfied","check-within","check-error","check-member-of","check-range"];function w(e){return!!("Expression"===e.kind&&e.children.length>=3&&"Variable"===e.children[0].kind&&y.includes(e.children[0].source))&&{actual:e.children[1]}}function x(e,n){var t={calls:[],stop:!1},r=0;if("Variable"===e.children[0].kind){var i={name:e.children[0].source,body:e};if(t.calls.push(i),t.stop=n(i),t.stop)return t;r=1}for(var s=r;s<e.children.length;s++){var a=e.children[s];if("Expression"===a.kind){var o,c=x(a,n);if((o=t.calls).push.apply(o,Object(g.a)(c.calls)),t.stop=c.stop,t.stop)return t}}return t}function E(e,n){if("Expression"!==e.kind)return null;var t=x(e,n);return t.stop&&0!==t.calls.length?t.calls[t.calls.length-1]:null}function O(e){if("Expression"===e.kind&&3===e.children.length&&Object(m.isMatch)(e.children[0],{kind:"Variable",source:"define"})&&"Expression"===e.children[1].kind&&e.children[1].children.length>0){for(var n=e.children[1],t=0;t<n.children.length;t++)if("Variable"!==n.children[t].kind)return!1;var r=n.children.map((function(e){return e.source}));return{name:r[0],argNames:r.slice(1),isTemplate:k(e),body:e.children[2]}}return!1}var j=function(){function e(n,t){Object(o.a)(this,e),this.actionArg=n(),!1!==this.actionArg?this.result=t(this.actionArg):this.result=!1}return Object(c.a)(e,[{key:"or",value:function(n,t){return!1!==this.actionArg?this:new e(n,t)}}]),e}(),N=function(){function e(n,t){Object(o.a)(this,e),this.remainingNodes=n,this.messages=[{kind:"General",warnings:[]}],this.templates=[],this.testThreshold=2,null!=t&&null!=t.testThreshold&&(this.testThreshold=t.testThreshold)}return Object(c.a)(e,[{key:"requireCurrentFunctionDesign",value:function(){var e=this.messages[this.messages.length-1];if("FunctionDesign"!==e.kind)throw new Error("The warning list at the current position is not a FunctionDesign");return e}},{key:"getOutputWarningLists",value:function(){return this.messages.filter((function(e){return e.warnings.length>0})).map((function(e){return{kind:"Output",title:"FunctionDesign"===e.kind?"In function design for ".concat(e.name):"Before first function design",warnings:e.warnings}}))}},{key:"lint",value:function(){for(;this.remainingNodes.length>0;)this.addSignature(),this.remainingNodes.length>0&&(this.addPurposeLines(),this.addTests(),this.finalize(this.requireCurrentFunctionDesign()));return this.getOutputWarningLists()}},{key:"finalize",value:function(e){e.purposeLines<1&&e.warnings.push("no purpose statement"),e.tests<this.testThreshold&&e.warnings.push("only ".concat(e.tests," tests"))}},{key:"getBodyWarnings",value:function(n){var t,r="Expression"!==(t=n.body).kind?[]:x(t,(function(){return!1})).calls,i=[];return r.filter((function(e){return"local"===e.name})).forEach((function(n,t){if(n.body.children.length>=2&&"Expression"===n.body.children[1].kind){var r=new e(n.body.children[1].children.slice(),{testThreshold:0});r.lint(),r.messages.filter((function(e){return e.warnings.length>0})).forEach((function(e){i.push.apply(i,Object(g.a)(e.warnings.map((function(n){var t=n.replace(/^within local .*: /,"");return"FunctionDesign"===e.kind?"within local def of ".concat(e.name,": ").concat(t):"within local: ".concat(t)}))))}))}})),i}},{key:"addSignature",value:function(){for(var e=this,n=function(){var n=p(e.remainingNodes.splice(0,1),1)[0],t=e.messages[e.messages.length-1],r=v(n);if(!1!==r)return e.messages.push(r),{v:void 0};new j((function(){return O(n)}),(function(n){var r;n.isTemplate?e.templates.push(n):(t.warnings.push("unexpected function definition for ".concat(n.name)),(r=t.warnings).push.apply(r,Object(g.a)(e.getBodyWarnings(n))))})).or((function(){return w(n)}),(function(e){t.warnings.push("unexpected test: ".concat(u(n)))}))};this.remainingNodes.length>0;){var t=n();if("object"==typeof t)return t.v}}},{key:"addPurposeLines",value:function(){for(var e=this.requireCurrentFunctionDesign();this.remainingNodes.length>0;){var n=this.remainingNodes[0];if("LineComment"===n.kind||"BlockComment"===n.kind)e.purposeLines+=1,this.remainingNodes.splice(0,1);else{if(!b(n))return;this.remainingNodes.splice(0,1)}}}},{key:"addTests",value:function(){for(var e=this,n=this.requireCurrentFunctionDesign(),t=function(){var t=e.remainingNodes[0];if(!1!==v(t))return{v:void 0};e.remainingNodes.splice(0,1),new j((function(){return O(t)}),(function(t){var r;t.isTemplate?e.templates.push(t):(null!=E(t.body,(function(e){return"big-bang"===e.name}))&&(n.tests=1e3),t.name!==n.name&&n.warnings.push("unexpected function definition for ".concat(t.name)),(r=n.warnings).push.apply(r,Object(g.a)(e.getBodyWarnings(t))))})).or((function(){return w(t)}),(function(e){n.tests+=1,null==E(e.actual,(function(e){return e.name===n.name}))&&n.warnings.push("expected test to call ".concat(n.name,": ").concat(u(t)))}))};this.remainingNodes.length>0;){var r=t();if("object"==typeof r)return r.v}}}],[{key:"fromParser",value:function(n){if(n.status!==l.Done)throw new Error("Can't create linter for unfinished parser");return new e(n.root.children.slice())}}]),e}();var S=function(e){function n(n){var t;return(t=e.call(this,n)||this).state={value:""},t.handleSubmit=t.handleSubmit.bind(Object(r.a)(t)),t}Object(i.a)(n,e);var t=n.prototype;return t.handleSubmit=function(){this.props.doSubmit(this.state.value)},t.render=function(){var e=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,a.a.createElement("textarea",{onChange:function(n){return e.setState({value:n.target.value})},className:"w-full font-mono text-sm leading-tight border-2 border-paper-dark focus:border-accent-200 p-2 placeholder-pen-light bg-paper",placeholder:"Paste code from DrRacket",spellCheck:!1,style:{height:"25rem"}})),a.a.createElement("button",{className:"bg-accent-200 hover:bg-accent text-white py-2 px-4 rounded",type:"submit",onClick:this.handleSubmit},"Check"))},n}(s.PureComponent),P=function(e){function n(n){var t;return(t=e.call(this,n)||this).state={warningGroups:!1,error:!1},t.doLint=t.doLint.bind(Object(r.a)(t)),t}Object(i.a)(n,e);var t=n.prototype;return t.doLint=function(e){var n,t=this;(n=e,new Promise((function(e,t){for(var r=new d(n);r.status===l.InProgress;)r.advance();r.status===l.Done?e(N.fromParser(r).lint()):r.status===l.FoundTrailing?t("Syntax error in file: trailing characters"):r.status===l.FoundUnclosed?t("Syntax error in file: unmatched parenthesis or bracket"):t("Unknown error")}))).then((function(e){t.setState({warningGroups:e,error:!1})}),(function(e){t.setState({warningGroups:!1,error:e})}))},t.render=function(){var e=null;if(!1!==this.state.error)e=a.a.createElement("div",{className:"mt-4"},a.a.createElement("em",{className:"font-bold text-danger"},this.state.error));else if(Array.isArray(this.state.warningGroups)){var n=this.state.warningGroups.length;e=a.a.createElement("div",{className:"mt-4"},a.a.createElement("h3",null,0===n?"0 warnings":"Warnings"),this.state.warningGroups.map((function(e,n){var t=e.title,r=e.warnings;return a.a.createElement("details",{className:"mb-4",open:!0,key:n},a.a.createElement("summary",{className:"p-1 bg-paper-darker cursor-pointer"},t),r.map((function(e,n){return a.a.createElement("p",{className:"ml-6 mb-0 text-sm font-mono",key:n},e)})))})))}return a.a.createElement("div",{className:this.props.className},a.a.createElement(S,{doSubmit:this.doLint}),e)},n}(a.a.Component);P.defaultProps={className:""};n.default=P},YuTi:function(e,n){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},vuIU:function(e,n,t){"use strict";function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}t.d(n,"a",(function(){return i}))}}]);
//# sourceMappingURL=16-77534c677680ac8b8fd1.js.map